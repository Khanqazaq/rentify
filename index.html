<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rentify - –ê—Ä–µ–Ω–¥–∞ –≤–µ—â–µ–π –º–µ–∂–¥—É –ª—é–¥—å–º–∏</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <a href="index.html" class="logo">Rentify</a>
                
                <div class="nav-search">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="–ü–æ–∏—Å–∫ –≤–µ—â–µ–π..." id="searchInput">
                </div>
                
                <div class="nav-menu">
                    <a href="items.html">–í—Å–µ –≤–µ—â–∏</a>
                    <a href="#" onclick="openAddModal(event)">–î–æ–±–∞–≤–∏—Ç—å –≤–µ—â—å</a>
                    <a href="login.html" class="btn-login">–í–æ–π—Ç–∏</a>
                    <div class="language-switcher">
                        <button class="lang-btn" onclick="changeLanguage('kk')">üá∞üáø</button>
                        <button class="lang-btn" onclick="changeLanguage('ru')">üá∑üá∫</button>
                    </div>
                </div>
                
                <button class="menu-toggle" onclick="toggleMenu()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">
                    –ê—Ä–µ–Ω–¥—É–π –Ω—É–∂–Ω—ã–µ –≤–µ—â–∏
                    <span class="gradient-text">–±—ã—Å—Ç—Ä–æ –∏ —É–¥–æ–±–Ω–æ</span>
                </h1>
                <p class="hero-description">
                    –ö–æ–≥–¥–∞ –≤–µ—â–∏ –Ω—É–∂–Ω—ã –Ω–∞ –¥–µ–Ω—å, –Ω–µ–¥–µ–ª—é –∏–ª–∏ –º–µ—Å—è—Ü ‚Äî –±–µ—Ä–∏ –≤ –∞—Ä–µ–Ω–¥—É —É –ª—é–¥–µ–π —Ä—è–¥–æ–º.
–ö–∞–º–µ—Ä—ã, –Ω–æ—É—Ç–±—É–∫–∏, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.
–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏. –ë–µ–∑–æ–ø–∞—Å–Ω–æ. –í—ã–≥–æ–¥–Ω–æ.
                </p>
                <div class="hero-buttons">
                    <a href="items.html" class="btn btn-primary">–ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫</a>
                    <a href="#" class="btn btn-outline" onclick="openAddModal(event)">–°–¥–∞—Ç—å –≤–µ—â—å –≤ –∞—Ä–µ–Ω–¥—É</a>
                </div>
            </div>
            
            <!-- Stats -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number">5000+</div>
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –≤–µ—â–µ–π</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">2000+</div>
                    <div class="stat-label">–î–æ–≤–æ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">50+</div>
                    <div class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">4.8‚òÖ</div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Search Section -->
    <section class="search-section">
        <div class="container">
            <div class="search-box">
                <div class="search-field">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="–ß—Ç–æ –≤—ã –∏—â–µ—Ç–µ?" id="searchBox">
                </div>
                <div class="search-field">
                    <i class="fas fa-map-marker-alt"></i>
                    <input type="text" placeholder="–ì–æ—Ä–æ–¥" id="cityBox">
                </div>
                <button class="btn btn-primary" onclick="searchItems()">–ù–∞–π—Ç–∏</button>
            </div>
        </div>
    </section>

    <!-- Categories -->
    <section class="categories">
        <div class="container">
            <h2 class="section-title">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
            <div class="categories-grid">
                <a href="items.html?category=electronics" class="category-card">
                    <div class="category-icon">üíª</div>
                    <div class="category-name">–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</div>
                </a>
                <a href="items.html?category=clothing" class="category-card">
                    <div class="category-icon">üëï</div>
                    <div class="category-name">–û–¥–µ–∂–¥–∞</div>
                </a>
                <a href="items.html?category=sports" class="category-card">
                    <div class="category-icon">‚öΩ</div>
                    <div class="category-name">–°–ø–æ—Ä—Ç</div>
                </a>
                <a href="items.html?category=auto" class="category-card">
                    <div class="category-icon">üöó</div>
                    <div class="category-name">–ê–≤—Ç–æ</div>
                </a>
                <a href="items.html?category=tools" class="category-card">
                    <div class="category-icon">üîß</div>
                    <div class="category-name">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div>
                </a>
                <a href="items.html?category=cameras" class="category-card">
                    <div class="category-icon">üì∑</div>
                    <div class="category-name">–ö–∞–º–µ—Ä—ã</div>
                </a>
                <a href="items.html?category=bicycles" class="category-card">
                    <div class="category-icon">üö¥</div>
                    <div class="category-name">–í–µ–ª–æ—Å–∏–ø–µ–¥—ã</div>
                </a>
                <a href="items.html?category=furniture" class="category-card">
                    <div class="category-icon">ü™ë</div>
                    <div class="category-name">–ú–µ–±–µ–ª—å</div>
                </a>
            </div>
        </div>
    </section>

    <!-- Featured Items -->
    <section class="featured-items">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –≤–µ—â–∏</h2>
                <a href="items.html" class="view-all">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ ‚Üí</a>
            </div>
            <div class="items-grid" id="featuredItems">
                <!-- Items will be loaded by JavaScript -->
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section class="how-it-works">
        <div class="container">
            <h2 class="section-title">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3>–ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—É—é –≤–µ—â—å</h3>
                    <p>–ò—â–∏—Ç–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, —Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ —Ü–µ–Ω–µ –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <h3>–ó–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –∏ –æ–ø–ª–∞—Ç–∏—Ç–µ</h3>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã –∞—Ä–µ–Ω–¥—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>–ü–æ–ª—É—á–∏—Ç–µ –≤–µ—â—å</h3>
                    <p>–í—Å—Ç—Ä–µ—Ç—å—Ç–µ—Å—å —Å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –∏ –∑–∞–±–µ—Ä–∏—Ç–µ –≤–µ—â—å –≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <h3>–û—Å—Ç–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤</h3>
                    <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ–≥–∏—Ç–µ –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials -->
    <section class="testimonials">
        <div class="container">
            <h2 class="section-title">–û—Ç–∑—ã–≤—ã –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
            <div class="testimonials-grid">
                <div class="testimonial">
                    <div class="testimonial-header">
                        <img src="assets/images/user1.jpg" alt="User" class="testimonial-avatar">
                        <div>
                            <div class="testimonial-name">–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤</div>
                            <div class="testimonial-role">–ê—Ä–µ–Ω–¥–æ–¥–∞—Ç–µ–ª—å</div>
                        </div>
                    </div>
                    <div class="testimonial-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    <p class="testimonial-text">–û—Ç–ª–∏—á–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞! –ó–∞ –º–µ—Å—è—Ü –∑–∞—Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –∞—Ä–µ–Ω–¥–µ —Å–≤–æ–µ–π –∫–∞–º–µ—Ä—ã –±–æ–ª—å—à–µ, —á–µ–º –ø–æ—Ç—Ä–∞—Ç–∏–ª –Ω–∞ –ø–æ–∫—É–ø–∫—É.</p>
                </div>
                <div class="testimonial">
                    <div class="testimonial-header">
                        <img src="assets/images/user2.jpg" alt="User" class="testimonial-avatar">
                        <div>
                            <div class="testimonial-name">–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞</div>
                            <div class="testimonial-role">–ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä</div>
                        </div>
                    </div>
                    <div class="testimonial-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    <p class="testimonial-text">–ê—Ä–µ–Ω–¥—É—é –≤–µ–ª–æ—Å–∏–ø–µ–¥ –∫–∞–∂–¥—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ. –ù–∞–º–Ω–æ–≥–æ –¥–µ—à–µ–≤–ª–µ, —á–µ–º –ø–æ–∫—É–ø–∞—Ç—å —Å–≤–æ–π!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 class="footer-logo">Rentify</h3>
                    <p>–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∞—Ä–µ–Ω–¥—ã –≤–µ—â–µ–π –º–µ–∂–¥—É –ª—é–¥—å–º–∏. –ë–µ–∑–æ–ø–∞—Å–Ω–æ, —É–¥–æ–±–Ω–æ –∏ –≤—ã–≥–æ–¥–Ω–æ.</p>
                </div>
                <div class="footer-section">
                    <h4>–ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏</h4>
                    <a href="items.html">–í—Å–µ –≤–µ—â–∏</a>
                    <a href="add-item.html">–î–æ–±–∞–≤–∏—Ç—å –≤–µ—â—å</a>
                    <a href="become-pro.html">–°—Ç–∞—Ç—å PRO</a>
                </div>
                <div class="footer-section">
                    <h4>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h4>
                    <a href="#">–ü–æ–º–æ—â—å</a>
                    <a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                    <a href="#">FAQ</a>
                </div>
                <div class="footer-section">
                    <h4>–ü—Ä–∞–≤–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                    <a href="privacy.html">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                    <a href="terms.html">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Rentify. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <!-- Add listing modal -->
    <div id="add-overlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.45); align-items:center; justify-content:center; z-index:10000;">
        <div style="background:#fff; width:520px; border-radius:12px; padding:20px; box-shadow:0 20px 60px rgba(0,0,0,0.25);">
            <h2 style="margin-top:0; text-align:center;">–°–¥–∞—Ç—å –≤–µ—â—å –≤ –∞—Ä–µ–Ω–¥—É</h2>
            <div style="margin-bottom:8px;">
                <label style="display:block; font-weight:600; margin-bottom:6px;">–ù–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–∏</label>
                <input id="item-title" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç–æ—Ä" style="width:100%; padding:10px; border-radius:8px; border:1px solid #e5e7eb;">
            </div>
            <div style="margin-bottom:8px;">
                <label style="display:block; font-weight:600; margin-bottom:6px;">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea id="item-desc" placeholder="–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏" style="width:100%; padding:10px; border-radius:8px; border:1px solid #e5e7eb; height:90px;"></textarea>
            </div>
            <div style="display:flex; gap:8px; margin-bottom:8px;">
                <div style="flex:1;">
                    <label style="display:block; font-weight:600; margin-bottom:6px;">–¶–µ–Ω–∞ (–≤ —Ç–µ–Ω–≥–µ / —Å—É—Ç–∫–∏)</label>
                    <input id="item-price" type="number" min="0" placeholder="1000" style="width:100%; padding:10px; border-radius:8px; border:1px solid #e5e7eb;">
                </div>
                <div style="flex:1;">
                    <label style="display:block; font-weight:600; margin-bottom:6px;">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input id="item-phone" type="tel" placeholder="7011234567" maxlength="10" style="width:100%; padding:10px; border-radius:8px; border:1px solid #e5e7eb;" oninput="this.value=this.value.replace(/[^0-9]/g,'')">
                </div>
            </div>
            <div style="margin-bottom:8px;">
                <label style="display:block; font-weight:600; margin-bottom:6px;">–ê–¥—Ä–µ—Å / –ì–æ—Ä–æ–¥</label>
                <input id="item-address" type="text" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, —Ä–∞–π–æ–Ω" style="width:100%; padding:10px; border-radius:8px; border:1px solid #e5e7eb;">
            </div>
            <div style="margin-bottom:8px;">
                <label style="display:block; font-weight:600; margin-bottom:6px;">–ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π (–≤—ã–±–µ—Ä–∏—Ç–µ –¥–æ 5)</label>
                <div id="gallery-thumbs" style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;"></div>
                <small style="color:#6b7280; display:block; margin-top:6px;">–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –≥–∞–ª–µ—Ä–µ–∏ ‚Äî –æ–Ω–∏ –±—É–¥—É—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω—ã –∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—é.</small>
            </div>
            <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:12px;">
                <button id="add-cancel" style="padding:10px 14px; border-radius:8px; background:#f3f4f6; border:none; cursor:pointer;">–û—Ç–º–µ–Ω–∞</button>
                <button id="add-save" style="padding:10px 14px; border-radius:8px; background:#4f46e5; color:#fff; border:none; cursor:pointer;">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Chat widget (Renter <> Owner) -->
    <div id="chatWidget" class="chat-widget" aria-hidden="false">
        <div class="chat-toggle" id="chatToggle" title="–ß–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º">–ß–∞—Ç</div>
        <div class="chat-panel" id="chatPanel" role="dialog" aria-label="–ß–∞—Ç –∞—Ä–µ–Ω–¥–∞">
            <div class="chat-header">
                <div style="display:flex; flex-direction:column; gap:6px; width:100%;">
                    <div style="display:flex; align-items:center; justify-content:space-between; gap:8px;">
                        <div class="chat-title">–°–æ–æ–±—â–µ–Ω–∏—è</div>
                        <button class="chat-close" id="chatClose" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
                    </div>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <select id="chatRole" style="padding:6px;border-radius:6px;border:1px solid var(--gray-200);font-size:0.9rem;">
                            <option value="renter">–Ø ‚Äî –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä</option>
                            <option value="owner">–Ø ‚Äî –∞—Ä–µ–Ω–¥–æ–¥–∞—Ç–µ–ª—å</option>
                        </select>
                        <input id="chatItemId" placeholder="ID –≤–µ—â–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä 1)" style="flex:1;padding:6px;border-radius:6px;border:1px solid var(--gray-200);font-size:0.9rem;" />
                        <button id="chatOpenConv" class="btn" style="padding:6px 8px;">–û—Ç–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            </div>
            <div class="chat-messages" id="chatMessages" aria-live="polite"></div>
            <div class="chat-input">
                <input id="chatInput" type="text" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." aria-label="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ">
                <button id="chatSend" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="./js/main.js"></script>
    <script src="js/language.js"></script>
    <script>
        // Add listing modal logic with image upload (up to 5 images)
        (function(){
            const overlay = document.getElementById('add-overlay');
            window.openAddModal = function(e){ if(e) e.preventDefault(); overlay.style.display='flex';
                // prefill address from saved location if available
                try{ const s = localStorage.getItem('user_location'); if(s){ const obj = JSON.parse(s); const addr = obj.city || obj.address || ''; if(addr) document.getElementById('item-address').value = addr; } }catch(e){}
            };

            const cancel = document.getElementById('add-cancel');
            const save = document.getElementById('add-save');
            const gallery = document.getElementById('gallery-thumbs');

            // Create a small built-in gallery of placeholder thumbnails (data-URL SVGs)
            const colors = ['#fde68a','#fbcfe8','#c7f9cc','#bbf7d0','#bae6fd','#ffd7d7','#e9d5ff','#fef3c7'];
            function makeSVGDataURL(text, bg){
                const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='320' height='240'><rect width='100%' height='100%' fill='${bg}'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Arial,sans-serif' font-size='28' fill='#111'>${text}</text></svg>`;
                return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
            }

            const galleryImages = [];
            for(let i=1;i<=8;i++){ galleryImages.push(makeSVGDataURL('–§–æ—Ç–æ '+i, colors[(i-1)%colors.length])); }

            let selectedImages = [];

            function renderGallery(){
                gallery.innerHTML = '';
                galleryImages.forEach((src, idx)=>{
                    const box = document.createElement('div');
                    box.style.width='80px'; box.style.height='80px'; box.style.borderRadius='8px'; box.style.overflow='hidden'; box.style.border='2px solid transparent'; box.style.display='flex'; box.style.alignItems='center'; box.style.justifyContent='center'; box.style.cursor='pointer';
                    const img = document.createElement('img'); img.src = src; img.style.width='100%'; img.style.height='100%'; img.style.objectFit='cover';
                    box.appendChild(img);
                    box.addEventListener('click', ()=>{
                        const pos = selectedImages.indexOf(src);
                        if(pos === -1){
                            if(selectedImages.length >= 5){ alert('–ú–∞–∫—Å–∏–º—É–º 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π'); return; }
                            selectedImages.push(src); box.style.border = '2px solid #4f46e5';
                        } else { selectedImages.splice(pos,1); box.style.border = '2px solid transparent'; }
                    });
                    gallery.appendChild(box);
                });
            }

            renderGallery();

            cancel && cancel.addEventListener('click', ()=>{ overlay.style.display='none'; selectedImages = []; renderGallery(); });

            save && save.addEventListener('click', ()=>{
                const title = (document.getElementById('item-title')||{}).value.trim();
                const desc = (document.getElementById('item-desc')||{}).value.trim();
                const price = (document.getElementById('item-price')||{}).value.trim();
                const phone = (document.getElementById('item-phone')||{}).value.trim();
                const address = (document.getElementById('item-address')||{}).value.trim();

                if(!title){ alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–µ—â–∏'); document.getElementById('item-title').focus(); return; }
                if(!desc){ alert('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ'); document.getElementById('item-desc').focus(); return; }
                if(!price || isNaN(price) || Number(price) <= 0){ alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É'); document.getElementById('item-price').focus(); return; }
                if(!/^\d{10}$/.test(phone)){ alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π 10-–∑–Ω–∞—á–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'); document.getElementById('item-phone').focus(); return; }
                if(!address){ alert('–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∏–ª–∏ –≥–æ—Ä–æ–¥'); document.getElementById('item-address').focus(); return; }

                const images = selectedImages.slice(0,5);

                const listing = {
                    id: 'l_' + Date.now(),
                    title, desc, price: Number(price), phone: '+7' + phone.replace(/\D/g,''), address,
                    images, created: Date.now()
                };

                try{
                    const raw = localStorage.getItem('listings');
                    const arr = raw ? JSON.parse(raw) : [];
                    arr.unshift(listing);
                    localStorage.setItem('listings', JSON.stringify(arr));
                }catch(e){ alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.'); console.error(e); return; }

                alert('–í–∞—à–∞ –≤–µ—â—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞!');
                overlay.style.display='none';
                selectedImages = []; renderGallery();
                window.location.href = 'items.html';
            });
        })();
    </script>
</body>
</html>

